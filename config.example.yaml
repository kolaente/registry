# Example configuration for Docker Registry
# Copy this file to config.yaml and customize as needed

server:
  # Address to listen on
  # NOTE: This registry only supports HTTP. For TLS/HTTPS, use a reverse proxy
  # like Traefik, nginx, or Caddy (see docker-compose.traefik.yml for example)
  addr: ":5000"

# User accounts with bcrypt-hashed passwords
# Generate with: htpasswd -nbBC 10 username password
users:
  # Username: admin, Password: password
  admin:
    password: "$2y$10$wGmIgzScW7ExkU6gPeNr9.KwmiwF3vnJ3IPasImRAr38i/TXZqloO"

  # Username: developer, Password: devpass
  developer:
    password: "$2y$10$rcZ1nX25EHturNDkCofPsej2UsSkHnLzMyGLdbULyevuhKj/p.gEa"

# Access Control List (ACL) rules
# Rules are evaluated in order; first match wins
acl:
  # Admin has full access to all repositories
  - account: "admin"
    name: "*"
    actions: ["*"]

  # Developer can push and pull to backend-* repositories
  - account: "developer"
    name: "myorg/backend-*"
    actions: ["pull", "push"]

  # Developer can only pull from frontend repository
  - account: "developer"
    name: "myorg/frontend"
    actions: ["pull"]

  # Example: read-only access for a user
  # - account: "readonly"
  #   name: "myorg/*"
  #   actions: ["pull"]

# Storage configuration
storage:
  filesystem:
    # Directory where images will be stored
    rootdirectory: "/data/registry"

# Authentication settings
auth:
  realm: "Registry"
  service: "Docker Registry"
  issuer: "registry-auth-server"

  # HMAC secret for JWT signing
  # Generate a strong secret with: openssl rand -base64 32
  hmac_secret: "your-secret-key-here"

# Rate limiting configuration
rate_limit:
  enabled: true
  requests_per_sec: 10  # Requests per second per IP address
  burst: 20             # Maximum burst size (allows temporary spikes)
